// src/utils/flags.ts
// 1) ã‚ˆãå‡ºã‚‹å›½åã¨åœ°åŸŸã®æ“¬ä¼¼ãƒ•ãƒ©ã‚°ï¼ˆåœ°åŸŸã¯åœ°çƒçµµæ–‡å­—ï¼‰
const FLAG_MAP: Record<string,string> = {
  // åœ°åŸŸ
  'ã‚¢ãƒ•ãƒªã‚«':'ğŸŒ','ä¸­ç±³':'ğŸŒ','å—ç±³':'ğŸŒ','ã‚¢ã‚¸ã‚¢':'ğŸŒ',
  // ã‚¢ãƒ¡ãƒªã‚«å¤§é™¸
  'ã‚¢ãƒ¡ãƒªã‚«':'ğŸ‡ºğŸ‡¸','ç±³å›½':'ğŸ‡ºğŸ‡¸','ãƒãƒ¯ã‚¤':'ğŸ‡ºğŸ‡¸',
  'ã‚³ãƒ­ãƒ³ãƒ“ã‚¢':'ğŸ‡¨ğŸ‡´','ãƒ–ãƒ©ã‚¸ãƒ«':'ğŸ‡§ğŸ‡·','ã‚°ã‚¢ãƒ†ãƒãƒ©':'ğŸ‡¬ğŸ‡¹','ã‚³ã‚¹ã‚¿ãƒªã‚«':'ğŸ‡¨ğŸ‡·',
  'ãƒ›ãƒ³ã‚¸ãƒ¥ãƒ©ã‚¹':'ğŸ‡­ğŸ‡³','ã‚¨ãƒ«ã‚µãƒ«ãƒãƒ‰ãƒ«':'ğŸ‡¸ğŸ‡»','ãƒ‹ã‚«ãƒ©ã‚°ã‚¢':'ğŸ‡³ğŸ‡®','ãƒ‘ãƒŠãƒ':'ğŸ‡µğŸ‡¦',
  'ãƒ¡ã‚­ã‚·ã‚³':'ğŸ‡²ğŸ‡½','ãƒšãƒ«ãƒ¼':'ğŸ‡µğŸ‡ª','ãƒœãƒªãƒ“ã‚¢':'ğŸ‡§ğŸ‡´','ã‚¨ã‚¯ã‚¢ãƒ‰ãƒ«':'ğŸ‡ªğŸ‡¨',
  // ã‚¢ãƒ•ãƒªã‚«
  'ã‚¨ãƒã‚ªãƒ”ã‚¢':'ğŸ‡ªğŸ‡¹','ã‚±ãƒ‹ã‚¢':'ğŸ‡°ğŸ‡ª','ãƒ«ãƒ¯ãƒ³ãƒ€':'ğŸ‡·ğŸ‡¼','ãƒ–ãƒ«ãƒ³ã‚¸':'ğŸ‡§ğŸ‡®',
  'ã‚¦ã‚¬ãƒ³ãƒ€':'ğŸ‡ºğŸ‡¬','ã‚¿ãƒ³ã‚¶ãƒ‹ã‚¢':'ğŸ‡¹ğŸ‡¿','ã‚³ãƒ³ã‚´æ°‘ä¸»å…±å’Œå›½':'ğŸ‡¨ğŸ‡©','ã‚³ãƒ³ã‚´DRC':'ğŸ‡¨ğŸ‡©',
  'ã‚³ãƒ¼ãƒˆã‚¸ãƒœãƒ¯ãƒ¼ãƒ«':'ğŸ‡¨ğŸ‡®','ã‚³ãƒ¼ãƒˆã‚¸ãƒ´ã‚©ãƒ¯ãƒ¼ãƒ«':'ğŸ‡¨ğŸ‡®',
  // ã‚¢ã‚¸ã‚¢
  'ã‚¤ã‚¨ãƒ¡ãƒ³':'ğŸ‡¾ğŸ‡ª','ã‚¤ãƒ³ãƒ‰ãƒã‚·ã‚¢':'ğŸ‡®ğŸ‡©','æ±ãƒ†ã‚£ãƒ¢ãƒ¼ãƒ«':'ğŸ‡¹ğŸ‡±','ãƒ™ãƒˆãƒŠãƒ ':'ğŸ‡»ğŸ‡³',
  'ã‚¤ãƒ³ãƒ‰':'ğŸ‡®ğŸ‡³','ã‚¿ã‚¤':'ğŸ‡¹ğŸ‡­','ãƒ©ã‚ªã‚¹':'ğŸ‡±ğŸ‡¦','ãƒŸãƒ£ãƒ³ãƒãƒ¼':'ğŸ‡²ğŸ‡²',
  'ãƒ•ã‚£ãƒªãƒ”ãƒ³':'ğŸ‡µğŸ‡­','ä¸­å›½':'ğŸ‡¨ğŸ‡³','æ—¥æœ¬':'ğŸ‡¯ğŸ‡µ','ãƒãƒ‘ãƒ¼ãƒ«':'ğŸ‡³ğŸ‡µ',
};

const SPLITTER = /[,ã€ï¼/]/g;

/** å…¥åŠ›æ–‡å­—åˆ—ä¸­ã«å«ã¾ã‚Œã‚‹å›½/åœ°åŸŸã«å¯¾å¿œã™ã‚‹ãƒ•ãƒ©ã‚°ï¼ˆéƒ¨åˆ†ä¸€è‡´OKï¼‰ */
export const flagFor = (s: string): string => {
  const key = Object.keys(FLAG_MAP).find(k => s.includes(k));
  return key ? FLAG_MAP[key] : '';
};

/** è¡¨ç¤ºç”¨ã«ã€ŒğŸ‡¨ğŸ‡´ã‚³ãƒ­ãƒ³ãƒ“ã‚¢ã€ã¿ãŸã„ãªå½¢ã¸ï¼ˆãƒ’ãƒƒãƒˆã—ãªã‘ã‚Œã°ãã®ã¾ã¾ï¼‰ */
export const flagify = (name: string) => `${flagFor(name)}${name}`;

/** "å›½, å›½ï¼åœ°åŸŸ" ç­‰ã®è¤‡åˆæ–‡å­—åˆ—ã‚’å›½æ——ä»˜ãã§æ•´å½¢ */
export const flagifyOriginList = (origins?: string | null) => {
  if (!origins) return 'â€”';
  return String(origins)
    .split(SPLITTER)
    .map(s => s.trim())
    .filter(Boolean)
    .map(flagify)
    .join('ã€');
};

/** "ã‚³ãƒ­ãƒ³ãƒ“ã‚¢, ãƒ–ãƒ©ã‚¸ãƒ«" â†’ ["ã‚³ãƒ­ãƒ³ãƒ“ã‚¢","ãƒ–ãƒ©ã‚¸ãƒ«"] */
export const splitOrigins = (origins?: string | null) => {
  if (!origins) return [];
  return String(origins)
    .split(SPLITTER)
    .map(s => s.trim())
    .filter(Boolean);
};
